<html lang="en" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
	layout:decorate="~{views/common/masterlayout}">
<html lang="en">
<head>
	<title>List Post</title>
	<style>
	/* sidebar css */
	.list-group.panel>span .list-group-item-success, .list-group.panel>.list-group-item-success
		{
		border-bottom-right-radius: 4px;
		border-bottom-left-radius: 4px;
		background: #21b75f;
		color: #ffffff;
	}
	/* end sidebar */
	</style>
</head>
<body>
	<th:block layout:fragment="content">
		<div class="container-fluid">
			<div class="row">
				<div class="col-md-2" style="padding-left: unset; width: 15%">
					<div id="MainMenu">
						<div class="list-group panel">
							<!-- <a href="#" class="list-group-item list-group-item-success" data-parent="#MainMenu">User Profile</a> -->
							<a href="#" class="list-group-item list-group-item-success"
								data-parent="#MainMenu">Payment Detail</a> <a href="#demo"
								class="list-group-item list-group-item-success"
								data-toggle="collapse" data-parent="#MainMenu">Post
								Management <i class="fa fa-caret-down"></i>
							</a>
							<div class="collapse" id="demo">
								<a th:href="@{/posts/create}" class="list-group-item">Create
									Post</a> <a th:href="@{/posts}" class="list-group-item">List
									Post</a>
							</div>
							<span sec:authorize="isAuthenticated()"> <a
								sec:authorize="hasAuthority('ROLE_ADMIN')" href="#demo1"
								class="list-group-item list-group-item-success"
								data-toggle="collapse" data-parent="#MainMenu">User
									Management <i class="fa fa-caret-down"></i>
							</a>
								<div class="collapse" id="demo1">
									<a th:href="@{/users}" class="list-group-item">List User</a>
								</div>
							</span>
						</div>
					</div>
				</div>

				<div class="col-md-10">
					<!-- <div class="page-title pull-left" th:if="${#authentication.getName() != null}" th:text="My Posts List"></div>-->
					<table class="table table-hover">
						<thead>
							<tr>
								<th>ID</th>
								<th>Title</th>
								<th>Category</th>
								<!--			<th>Content</th>-->
								<th>Date Created</th>
								<th>Author</th>
								<th>Average Rating</th>
								<th>Rate Count</th>
								<th>Status</th>
								<th class="text-center"
									sec:authorize="hasAuthority('ROLE_ADMIN')">Action</th>
							</tr>
						</thead>
						<tbody>
							<tr th:each="p : ${pager.posts}">
								<td th:text="${p.id}"></td>
								<td th:text="${p.title}"></td>
								<td th:text="${p.category}"></td>
								<!--			<td th:text="${p.body}"></td>-->
								<td th:text="${#dates.format(p.createDate, 'dd-MMM-yyyy')}"></td>
								<td><span th:if="${p.user}" th:remove="tag"> <!--	          		<i>by</i>-->
										<span
										th:text="${p.user.firstName != null ? p.user.firstName+', '+p.user.lastName : p.user.username}">Default
											Author</span>
								</span></td>
								<td th:text="${p.avgRating}"></td>
								<td th:text="${p.ratedCount}"></td>
								<td class="text-center" sec:authorize="isAuthenticated()">
									<div sec:authorize="hasAuthority('ROLE_ADMIN')">
										<!--	<form th:action="@{/posts/setStatus/{id}(id=${p.id})}">-->
										<!--		<button class="btn " th:classappend="${p.status}? 'btn-success': 'btn-warning'" th:text="${p.status} ? 'Pubished':'Publish'"></button>-->
										<!--	</form>	-->
										<form th:action="@{/posts/view/{id}(id=${p.id})}">
											<button class="btn btn-danger" th:if="${p.status == false}"
												th:text="'Review'"></button>
										</form>
										<button class="btn btn-success" th:if="${p.status}" th:text="'Published'"></button>
									</div>
									<div sec:authorize="hasAuthority('ROLE_USER')">
										<a th:text="${p.status} ? 'Published':'Under Review'"></a>
									</div>

								</td>
								<td class="text-center"
									sec:authorize="hasAuthority('ROLE_ADMIN')"><a
									th:href="@{'/posts/edit/' + ${p.id}}"><span
										class="fa fa-edit"></span><</a> <!-- <a href="#" th:href="@{/posts/edit/{id}/(id=${p.id})}"><span class="fa fa-edit"></span></a>-->
									<a data-toggle="modal" data-target="#modal-warning"
									th:attr="data-target='#modal-warning'+${p.id }"><span
										class="glyphicon glyphicon-trash"></span></a>

									<div class="modal modal-warning fade in"
										th:id="modal-warning+${p.id }">
										<div class="modal-dialog">
											<div class="modal-content">
												<div class="modal-header">
													<button type="button" class="close" data-dismiss="modal"
														aria-label="Close">
														<span aria-hidden="true">Ã—</span>
													</button>
													<h5 class="modal-title">Delete Post</h5>
												</div>
												<div class="modal-body">
													<h3>Are you sure want to delete this Post?</h3>
												</div>
												<div class="modal-footer">
													<button type="button"
														class="btn btn-outline pull-left btn-warning"
														data-dismiss="modal">Close</button>
													<a type="button" class="btn btn-outline"
														th:href="@{/posts/delete/{id}(id=${p.id})}"><i
														class="fa fa-check"></i>&nbsp;Yes</a>
												</div>
											</div>
										</div>
									</div>
									<!--	<a href="#" role="button" data-toggle="modal" data-target="#myModal"><span class="fa fa-trash"></span></a>-->
									<!--    The Modal -->
									<!--    <div class="modal fade" id="myModal">-->
									<!--      <div class="modal-dialog"> -->
									<!--  	<div class="modal-content">-->
									<!--        &lt;!&ndash; Modal Header &ndash;&gt;-->
									<!--        <div class="modal-header">-->
									<!--          <h4 class="modal-title"><span class="fa fa-trash"></span>&nbsp;Confirm Delete</h4>-->
									<!--           <button type="button" class="close" data-dismiss="modal">&times;</button>-->
									<!--         </div>-->
									<!--   	<div class="modal-body">-->
									<!--		<p>Are you sure you want to delete this post? </p>-->
									<!--    </div>-->
									<!--   	&lt;!&ndash; Modal footer &ndash;&gt;-->
									<!--   	<div class="modal-footer">-->
									<!--        <a th:href="@{'/posts/delete/'+${p.id}}"><button type="button" class="btn btn-danger">Delete</button></a>-->
									<!--        <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>-->
									<!--   	</div>-->
									<!--   	</div>-->
									<!--   	</div>-->
									<!--   	</div>-->
								</td>
							</tr>
						</tbody>
					</table>

					<div class="row">
						<div class="row form-row ">
							<div class="form-group col-lg-8col-lg-12">
							<div th:replace="/fragments/pagination :: pagination(URLparameter='/posts')" />
							</div>
						</div>
						
						<!--			<div class="col-md-12">-->
						<!--				<ul class="pagination justify-content-center">-->
						<!--					&lt;!&ndash; Send this if you want to let users to change page size property-->
						<!--					<li th:class="${posts.number eq 0} ? 'page-item disabled' : 'page-item'">-->
						<!--			            <a class="page-link" th:if="${not pager.posts.first}" th:href="@{${'/posts'}(page=${posts.number-1},size=${posts.size})}">Previous</a>-->
						<!--			            <a class="page-link" th:if="${pager.posts.first}" href="#">Previous</a>-->
						<!--			        </li>-->
						<!--			        &ndash;&gt;-->

						<!--			        <li th:class="${pager.posts.number eq 0} ? 'page-item disabled' : 'page-item'">-->
						<!--			            <a class="page-link" th:if="${not pager.posts.first}" th:href="@{${'/posts'}(page=${pager.posts.number-1})}">&laquo;</a>-->
						<!--			            <a class="page-link" th:if="${pager.posts.first}" href="#">&laquo;</a>-->
						<!--			        </li>-->

						<!--			        <li th:each="pageNo : ${#numbers.sequence(0, pager.posts.totalPages - 1)}" th:class="${pager.posts.number eq pageNo} ? 'page-item active' : 'page-item'">-->
						<!--			            <a class="page-link" th:if="${pager.posts.number  eq pageNo}" href="#">-->
						<!--			                <span th:text="${pageNo + 1}"></span>-->
						<!--			            </a>-->
						<!--			            <a class="page-link" th:if="${not (pager.posts.number  eq pageNo)}" th:href="@{${'/posts'}(page=${pageNo})}">-->
						<!--			                <span th:text="${pageNo + 1}"></span>-->
						<!--			            </a>-->

						<!--			        </li>-->
						<!--			        <li th:class="${pager.posts.number + 1 ge pager.posts.totalPages} ? 'page-item disabled' : 'page-item'">-->
						<!--			            <a class="page-link" th:if="${not pager.posts.last}" th:href="@{${'/posts'}(page=${pager.posts.number+1})}">&raquo;</a>-->
						<!--			            <a class="page-link" th:if="${pager.posts.last}" href="#">&raquo;</a>-->
						<!--			        </li>-->
						<!--				</ul>&lt;!&ndash; ./ pagination &ndash;&gt;-->
						<!--			</div>&lt;!&ndash; ./ col-md-7 &ndash;&gt;-->
					</div>
				</div>

			</div>
		</div>
	</th:block>
	
</body>
</html>