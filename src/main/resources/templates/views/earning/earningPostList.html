<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      layout:decorate="~{views/common/masterlayout}">
<html lang="en">
<head></head>
<body>
<th:block layout:fragment="content">

    <div class="container">
        <!--			<div class="page-title pull-left" th:if="${#authentication.getName() != null}" th:text="My Posts List"></div>-->
        <table class="table table-hover">
            <thead>
            <tr>
                <th>S.N.</th>
                <th>Title</th>
                <th>Category</th>
                <th>Date Created</th>
                <th>Average Rating</th>
                <th>Rate Count</th>
                <th sec:authorize="hasAnyAuthority('ROLE_USER')">Earning</th>
                <th sec:authorize="hasAnyAuthority('ROLE_USER')">Claim</th>
                <th class="text-center" sec:authorize="hasAuthority('ROLE_ADMIN')">Issue Payment</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="p,i : ${pager.posts}">
                <td th:text="${i.count}"></td>
                <td th:text="${p.title}"></td>
                <td th:text="${p.category}"></td>
                <td th:text="${#dates.format(p.createDate, 'dd-MMM-yyyy')}"></td>
                <td th:text="${p.avgRating}"></td>
                <td th:text="${p.ratedCount}"></td>
                <td class="text-center" sec:authorize="hasAnyAuthority('ROLE_USER')" th:text="${p.earning}"></td>
                <td class="text-center" sec:authorize="isAuthenticated()" >
                    <div sec:authorize="hasAuthority('ROLE_USER')">
                        <form th:action="@{/payment/calculate/{id}(id=${p.id})}">
                            <button class="btn btn-danger"  th:text="'Claim Now'"></button>
                        </form>

                    </div>

                </td>
                <td class="text-center" sec:authorize="isAuthenticated()">
                    <div sec:authorize="hasAuthority('ROLE_ADMIN')">
                        <form th:action="@{/payment/issue/{id}(id=${p.id})}">
                            <button class="btn btn-danger"  th:text="'Send'"></button>
                        </form>

                    </div>

                </td>

                    <!--				<a href="#" role="button" data-toggle="modal" data-target="#myModal"><span class="fa fa-trash"></span></a>-->
                    <!-- The Modal -->
                    <!--                <div class="modal fade" id="myModal">-->
                    <!--                    <div class="modal-dialog">-->
                    <!--                        <div class="modal-content">-->
                    <!--                            &lt;!&ndash; Modal Header &ndash;&gt;-->
                    <!--                            <div class="modal-header">-->
                    <!--                                <h4 class="modal-title"><span class="fa fa-trash"></span>&nbsp;Confirm Delete</h4>-->
                    <!--                                <button type="button" class="close" data-dismiss="modal">&times;</button>-->
                    <!--                            </div>-->
                    <!--                            <div class="modal-body">-->
                    <!--				                <p>Are you sure you want to delete this post? </p>-->
                    <!--				            </div>-->
                    <!--                            &lt;!&ndash; Modal footer &ndash;&gt;-->
                    <!--                            <div class="modal-footer">-->
                    <!--                                <a th:href="@{'/posts/delete/'+${p.id}}"><button type="button" class="btn btn-danger">Delete</button></a>-->
                    <!--                                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>-->
                    <!--                            </div>-->
                    <!--                        </div>-->
                    <!--                    </div>-->
                    <!--                </div>-->
                </td>
            </tr>
            </tbody>
        </table>
        <div class="row">
            <div class="row form-row ">
                <div class="form-group col-lg-8col-lg-12">

                    <div th:replace="/fragments/pagination :: pagination(URLparameter='/posts')"/>
                </div>

            </div>
            <!--			<div class="col-md-12">-->
            <!--				<ul class="pagination justify-content-center">-->
            <!--					&lt;!&ndash; Send this if you want to let users to change page size property-->
            <!--					<li th:class="${posts.number eq 0} ? 'page-item disabled' : 'page-item'">-->
            <!--			            <a class="page-link" th:if="${not pager.posts.first}" th:href="@{${'/posts'}(page=${posts.number-1},size=${posts.size})}">Previous</a>-->
            <!--			            <a class="page-link" th:if="${pager.posts.first}" href="#">Previous</a>-->
            <!--			        </li>-->
            <!--			        &ndash;&gt;-->

            <!--			        <li th:class="${pager.posts.number eq 0} ? 'page-item disabled' : 'page-item'">-->
            <!--			            <a class="page-link" th:if="${not pager.posts.first}" th:href="@{${'/posts'}(page=${pager.posts.number-1})}">&laquo;</a>-->
            <!--			            <a class="page-link" th:if="${pager.posts.first}" href="#">&laquo;</a>-->
            <!--			        </li>-->

            <!--			        <li th:each="pageNo : ${#numbers.sequence(0, pager.posts.totalPages - 1)}" th:class="${pager.posts.number eq pageNo} ? 'page-item active' : 'page-item'">-->
            <!--			            <a class="page-link" th:if="${pager.posts.number  eq pageNo}" href="#">-->
            <!--			                <span th:text="${pageNo + 1}"></span>-->
            <!--			            </a>-->
            <!--			            <a class="page-link" th:if="${not (pager.posts.number  eq pageNo)}" th:href="@{${'/posts'}(page=${pageNo})}">-->
            <!--			                <span th:text="${pageNo + 1}"></span>-->
            <!--			            </a>-->

            <!--			        </li>-->
            <!--			        <li th:class="${pager.posts.number + 1 ge pager.posts.totalPages} ? 'page-item disabled' : 'page-item'">-->
            <!--			            <a class="page-link" th:if="${not pager.posts.last}" th:href="@{${'/posts'}(page=${pager.posts.number+1})}">&raquo;</a>-->
            <!--			            <a class="page-link" th:if="${pager.posts.last}" href="#">&raquo;</a>-->
            <!--			        </li>-->
            <!--				</ul>&lt;!&ndash; ./ pagination &ndash;&gt;-->
            <!--			</div>&lt;!&ndash; ./ col-md-7 &ndash;&gt;-->
        </div><!-- ./ row -->
    </div><!-- ./ container -->
    <!-- The footer coming from layout -->
</th:block>
</body>
</html>